<story-context id="bmad/bmm/workflows/4-implementation/story-context/template" v="1.0">
  <metadata>
    <epicId>3</epicId>
    <storyId>3.5</storyId>
    <title>Add Example App Documentation and Testing</title>
    <status>drafted</status>
    <generatedAt>2025-11-17</generatedAt>
    <generator>BMAD Story Context Workflow</generator>
    <sourceStoryPath>docs/loqa-audio-bridge/sprint-artifacts/stories/3-5-add-example-app-documentation-and-testing.md</sourceStoryPath>
  </metadata>

  <story>
    <asA>developer</asA>
    <iWant>the example app fully documented and tested</iWant>
    <soThat>it serves as reliable integration proof (FR31, FR32)</soThat>
    <tasks>
      - Task 1: Create comprehensive README.md (quick start, prerequisites)
      - Task 2: Document what the example demonstrates (core features, integration patterns)
      - Task 3: Add code walkthrough (annotated code snippets with 5 key integration steps)
      - Task 4: Add development commands (installation, iOS/Android build commands)
      - Task 5: Add troubleshooting section (iOS issues, Android issues, general issues)
      - Task 6: Add links to main documentation (API docs, integration guide, architecture)
      - Task 7: Test example app on iOS (clean slate testing, permission flow, streaming validation)
      - Task 8: Test example app on Android (clean slate testing, permission flow, streaming validation)
      - Task 9: Document timing results (build times, total integration time less than 10 minutes)
      - Task 10: Create evidence archive (screenshots, build logs, timing data)
    </tasks>
  </story>

  <acceptanceCriteria>
    AC1: example/README.md created with Quick Start section
    AC2: "What This Example Demonstrates" section added
    AC3: Code Walkthrough section added with 5 key snippets
    AC4: Development Commands section added
    AC5: Troubleshooting section added
    AC6: iOS clean slate testing completed (app builds, launches, permission works, streaming works, no crashes)
    AC7: Android clean slate testing completed (app builds, launches, permission works, streaming works, no crashes)
    AC8: Build timing documented (total integration time less than 10 minutes)
  </acceptanceCriteria>

  <artifacts>
    <docs>
      <doc>
        <path>docs/loqa-audio-bridge/sprint-artifacts/tech-spec-epic-3.md</path>
        <title>Epic 3 Technical Specification: Autolinking & Integration Proof</title>
        <section>Story 3.5: Example App Testing Workflow</section>
        <snippet>Story 3.5 validates example app works flawlessly on both platforms with comprehensive README documentation. Testing proves autolinking and integration are production-ready with less than 10 minute integration time.</snippet>
      </doc>
      <doc>
        <path>docs/loqa-audio-bridge/sprint-artifacts/tech-spec-epic-3.md</path>
        <title>Epic 3 Technical Specification</title>
        <section>Non-Functional Requirements - NFR1: Integration Time Reduction</section>
        <snippet>Target: Installation to running app in less than 30 minutes (vs 9 hours in v0.2.0). Breakdown: iOS build less than 10 minutes, Android build less than 10 minutes. Example app validates this target.</snippet>
      </doc>
      <doc>
        <path>docs/loqa-audio-bridge/architecture.md</path>
        <title>Architecture Document - v0.3.0</title>
        <section>Section 7.2: Consumer Integration Flow</section>
        <snippet>Expected integration time: less than 30 minutes from npm install to running app (vs 9 hours in v0.2.0). Example app demonstrates this improvement with documented timing.</snippet>
      </doc>
    </docs>
    <code>
      <artifact>
        <path>modules/loqa-audio-bridge/example/README.md</path>
        <kind>documentation</kind>
        <symbol>README.md</symbol>
        <lines>all</lines>
        <reason>Primary deliverable of Story 3.5. Comprehensive example app documentation including quick start, code walkthrough, troubleshooting, and build timing.</reason>
      </artifact>
      <artifact>
        <path>modules/loqa-audio-bridge/example/App.tsx</path>
        <kind>component</kind>
        <symbol>App.tsx</symbol>
        <lines>all</lines>
        <reason>Example app implementation from Story 3.4. README code walkthrough extracts key snippets from this file to explain integration patterns.</reason>
      </artifact>
      <artifact>
        <path>modules/loqa-audio-bridge/example/package.json</path>
        <kind>configuration</kind>
        <symbol>package.json</symbol>
        <lines>all</lines>
        <reason>Example app dependencies. README documents npm install command that uses this file.</reason>
      </artifact>
      <artifact>
        <path>modules/loqa-audio-bridge/example/app.json</path>
        <kind>configuration</kind>
        <symbol>app.json</symbol>
        <lines>all</lines>
        <reason>Expo app configuration with microphone permissions. Referenced in README troubleshooting section.</reason>
      </artifact>
      <artifact>
        <path>modules/loqa-audio-bridge/index.ts</path>
        <kind>module-api</kind>
        <symbol>index.ts</symbol>
        <lines>1-150</lines>
        <reason>Module API documentation source. README code walkthrough references these functions (startAudioStream, stopAudioStream, addAudioSampleListener).</reason>
      </artifact>
    </code>
    <dependencies>
      <node>
        <package>@loqalabs/loqa-audio-bridge</package>
        <version>file:..</version>
        <reason>Module being documented and tested</reason>
      </node>
      <node>
        <package>expo</package>
        <version>~52.0.0</version>
        <reason>Expo framework for example app</reason>
      </node>
      <node>
        <package>expo-av</package>
        <version>latest</version>
        <reason>Permission handling library documented in code walkthrough</reason>
      </node>
    </dependencies>
    <platform>
      <tool>iOS Simulator</tool>
      <version>17.0+</version>
      <reason>Testing target for iOS clean slate validation (uses Mac microphone)</reason>
    </platform>
    <platform>
      <tool>Android Emulator</tool>
      <version>API 34</version>
      <reason>Testing target for Android clean slate validation (virtual or device mic)</reason>
    </platform>
  </artifacts>

  <constraints>
    - README.md must be created in modules/loqa-audio-bridge/example/ directory
    - Quick Start section must provide 3-step installation process (npm install, npx expo run:ios, npx expo run:android)
    - Code walkthrough must include exactly 5 key snippets: (1) import module, (2) request permission, (3) start streaming, (4) listen for samples, (5) cleanup on unmount
    - Code snippets must use markdown TypeScript syntax highlighting
    - Troubleshooting section must cover: iOS pod install failures, Android SDK issues, Metro bundler errors, module not found errors
    - Build timing must be documented for M1/M-series Mac: iOS ~3-4 minutes, Android ~4-5 minutes, total less than 10 minutes
    - Clean slate testing must delete node_modules, ios, android before fresh install (proves example works for first-time users)
    - Testing must validate: permission dialog appears, permission grant works, streaming starts/stops, RMS visualization updates, no crashes
    - Evidence archive must include: 8 screenshots (4 iOS, 4 Android showing app states), 2 build logs (iOS success, Android success), timing data table
    - Must validate Epic 3 success criteria: total integration time less than 30 minutes (less than 10 minutes for example app specifically)
  </constraints>

  <interfaces>
    <interface>
      <name>README.md Structure</name>
      <kind>Documentation</kind>
      <signature>
        # Loqa Audio Bridge Example
        ## Quick Start
        ## Prerequisites
        ## What This Example Demonstrates
        ## Code Walkthrough
        ## Development Commands
        ## Troubleshooting
        ## Build Times
        ## Learn More
      </signature>
      <path>modules/loqa-audio-bridge/example/README.md</path>
    </interface>
    <interface>
      <name>Clean Slate Test Commands</name>
      <kind>Testing Workflow</kind>
      <signature>
        cd example
        rm -rf node_modules ios android
        npm install
        npx expo prebuild
        npx expo run:ios
      </signature>
      <path>n/a</path>
    </interface>
    <interface>
      <name>Evidence Collection</name>
      <kind>Documentation Artifact</kind>
      <signature>
        docs/loqa-audio-bridge/sprint-artifacts/stories/evidence/3-5/
        - Screenshots: 3-5-ios-*.png, 3-5-android-*.png
        - Build logs: 3-5-ios-build.log, 3-5-android-build.log
        - Timing data: 3-5-timing-table.md
      </signature>
      <path>docs/loqa-audio-bridge/sprint-artifacts/stories/evidence/3-5/</path>
    </interface>
  </interfaces>

  <tests>
    <standards>
      This is a documentation and validation story. Testing approach combines documentation creation with comprehensive platform testing:
      1. Create README.md with all required sections (quick start, prerequisites, what it demonstrates, code walkthrough, development commands, troubleshooting, build times, learn more)
      2. Perform iOS clean slate test: delete node_modules/ios/android, run npm install, run npx expo prebuild, run npx expo run:ios, time the process, test permission flow, test streaming functionality, verify RMS visualization updates, verify no crashes
      3. Perform Android clean slate test: run npx expo run:android, time the process, test permission flow, test streaming functionality, verify RMS visualization updates, verify no crashes
      4. Document build times: iOS first build ~3-4 minutes, Android first build ~4-5 minutes, total less than 10 minutes (contributes to Epic 3 less than 30 minute target)
      5. Collect evidence: capture screenshots at each app state (4 iOS: launched, permission dialog, streaming active, streaming stopped; 4 Android: same states), save build logs showing BUILD SUCCESSFUL, create timing data table
      6. Validate timing meets Epic 3 target: less than 10 minutes for example app, less than 30 minutes for total integration (includes Stories 3.1-3.2 autolinking validation)
      Success criteria: README complete, both platforms tested successfully, timing documented and meets targets, evidence archived.
    </standards>
    <locations>
      - modules/loqa-audio-bridge/example/README.md (documentation)
      - docs/loqa-audio-bridge/sprint-artifacts/stories/evidence/3-5/ (evidence archive)
    </locations>
    <ideas>
      - Test Idea 1 (AC1-AC5): Create README.md sections and verify quick start has 3 clear steps, code walkthrough has 5 snippets with TypeScript syntax highlighting, troubleshooting covers common issues
      - Test Idea 2 (AC6): iOS clean slate test - delete build artifacts, fresh install, run build, time the process, verify under 10 minutes, test permission dialog appears and grant works, test Start button triggers streaming, test RMS bar animates with audio input, test Stop button halts streaming, verify zero crashes
      - Test Idea 3 (AC7): Android clean slate test - run npx expo run:android, time the process, verify under 10 minutes, test permission dialog appears and grant works, test Start button triggers streaming, test RMS bar animates, test Stop button halts streaming, verify zero crashes
      - Test Idea 4 (AC8): Document timing results in README Build Times section: iOS first build X minutes, Android first build Y minutes, total less than 10 minutes, comparison to v0.2.0 (9 hours) showing 54x improvement
      - Test Idea 5: Create evidence archive with 8 screenshots showing complete user journey on both platforms, 2 build logs proving zero errors, timing data table proving less than 10 minute target met
      - Test Idea 6 (Epic 3 validation): Verify total integration time from Stories 3.1-3.5: autolinking validation (less than 5 min iOS + less than 5 min Android) + example app (less than 10 min total) = less than 20 minutes (well under 30 minute Epic 3 target)
      - Test Idea 7: Validate README completeness by having a developer unfamiliar with the module follow instructions - if they can get app running without external help, documentation is sufficient
    </ideas>
  </tests>
</story-context>
